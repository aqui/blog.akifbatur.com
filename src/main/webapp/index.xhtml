<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:sec="http://www.springframework.org/security/tags">

	<h:head>
		<meta charset="utf-8"></meta>
		<title>akif batur - blog</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
		<link href="resources/css/bootstrap.css" rel="stylesheet"></link>
		<link href="resources/images/terminal.ico" rel="icon"></link>
		<script src="resources/js/bootstrap.min.js"></script>
		<script src="resources/js/jquery-1.11.3.js"></script>
	</h:head>
	
	<h:body>
	request = #{request}
	<br/>
	username = #{request.getUserPrincipal().getName()}
	<br/>
	all= #{request.getUserPrincipal()}
	<br/>
	username = #{request.userPrincipal.name}
	<br/>
	principal = #{request.userPrincipal.principal}
	<br/>
	credentials = #{request.userPrincipal.credentials}
	<br/>
	details = #{request.userPrincipal.details}
	<br/>
	user enabled = #{request.userPrincipal.principal.enabled}
	<br/>
	username = #{request.userPrincipal.principal.username}
	<br/>
	password = #{request.userPrincipal.principal.password}
	<br/>
	authorities = #{request.userPrincipal.principal.authorities}
	<br/>
	authorities size = #{request.userPrincipal.principal.authorities.size()}
	<br/>
	accountNonExpired = #{request.userPrincipal.principal.accountNonExpired}
	<br/>
	accountNonLocked = #{request.userPrincipal.principal.accountNonLocked}
	<br/>
	credentialsNonExpired = #{request.userPrincipal.principal.credentialsNonExpired}
	<br/>
	<sec:authorize access="isAuthenticated()">
		Authenticated
	</sec:authorize>
	<br/>
	<sec:authorize access="hasAnyRole('ROLE_USER,ROLE_ADMIN')">
		0
	</sec:authorize>
	<br/>
	<sec:authorize ifAllGranted="ROLE_USER, ROLE_ADMIN">
		1
	</sec:authorize>
	<br/>
	<sec:authorize ifNotGranted="ROLE_USER">
		2
	</sec:authorize>
	<br/>
	<sec:authorize ifAnyGranted="ROLE_USER, ROLE_ADMIN">
		3
	</sec:authorize>
	<!-- Rendered only if user has all of the listed roles -->
	<h:outputText value="Lorem ipsum dolor sit amet" rendered="#{sec:areAllGranted('ROLE_FOO, ROLE_BAR')}"/>
	<br/>
	<!-- Rendered only if user does not have any of the listed roles -->
	<h:outputText value="Lorem ipsum dolor sit amet" rendered="#{sec:areNotGranted('ROLE_FOO, ROLE_BAR')}"/>
	<br/>
	<!-- Rendered only if user has any of the listed roles -->
	<h:outputText value="Lorem ipsum dolor sit amet" rendered="#{sec:areAnyGranted('ROLE_FOO, ROLE_BAR')}"/>
	<br/>
	<!-- Rendered only if user has access to given HTTP method/URL as defined in Spring Security configuration -->
	<h:outputText value="Lorem ipsum dolor sit amet" rendered="#{sec:isAllowed('/admin', 'GET')}"/>
	<br/>
		<form action="${request.contextPath}/logout" method="post" name="logoutForm">
			<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
			<a href="#" onclick='document.logoutForm.submit();'>logout</a>
		</form>
	</h:body>
</html>